<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Quizapp refactored to ReactJS</title>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
    	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> -->
	</head>
	<body>
		<div id="content"></div>
  <script type="text/jsx">
	var QuestionsBox = React.createClass({
		getInitialState: function() {
			return {
				currentQuestion: 0,
				answerSelections: [],
				timePerQuestion: 10
			}
		},
		choiceMade: function(id) {
			var answers = this.state.answerSelections.slice();
			answers.push(id);

			var newState = {
				currentQuestion: this.state.currentQuestion + 1,
				answerSelections: answers,
				timePerQuestion: this.state.timePerQuestion
			};

			this.setState(newState);
		},
		render: function() {
			var question = this.props.quiz[this.state.currentQuestion];

			return (
				<div className="questionsbox">
					<QuestionPrompt question={question.prompt} />
					<Choices choices={question.choices} onClick={this.choiceMade} />
				</div>
			);
		}
	});

	var QuestionPrompt = React.createClass({
		render: function() {
			return (
				<h1>{this.props.question}</h1>
			);
		}
	});

	var Choices = React.createClass({
		render: function() {
			var clickHandler = this.props.onClick;

			var choices = this.props.choices.map(function(choice, i) {
				return (
					<li key={i}><button onClick={clickHandler.bind(null, i)}>{choice}</button></li>
				);
			});

			// es6:
			// var choices = this.props.choices.map((choice, i) => <li key={i}>{choice}</li>);

			return (
				<div>
					{choices}
				</div>
			);
		}
	});

var quiz = [
	{
		prompt: "What is Bran unable to do due to his injuries?",
		choices: ["Sleep","Archery","Walk","Eat"],
		answer: 2
	},
	{
		prompt: "Where is Theon Greyjoy tasked with raiding using only one ship by his father?",
		choices: ["Villages along the Stony Shore","Coastal towns of Bear Island","Ports along Blazewater Bay","Cape Kraken"],
		answer: 0
	},
	{
		prompt: "As Maester Luwin is dying, he tells Osha to take Rickon and Bran Stark to",
		choices: ["Riverrun to find their mother","the Wall to find their brother Jon","Rivverun to find Rob", "King's Landing to find Arya and Sansa","find Benjen Stark north of the Wall"],
		answer: "the Wall to find their brother Jon"
	},
	{
		prompt: "What does Arya earn after she helped the Hound in the fight with Polliver's men?",
		choices: ["Horse","Armor","Chicken","Freedom"],
		answer: "Horse"
	},
	{
		prompt: "Who does Robb Stark send to make an alliance with Balon Greyjoy?",
		choices: ["Catelyn","Bran","Lord Umber","Theon"],
		answer: "Theon"
	},
	{
		prompt: "Which city is Ser Loras Tyrell the heir to?",
		choices: ["Riverrun","King's Landing","Highgarden","Winterfell"],
		answer: "Highgarden"
	},
	{
		prompt: "Who does Sansa beg to light a candle for her in Winterfell?",
		choices: ["Theon","Podrick","Brienne","Roose"],
		answer: "Theon"
	},
	{
		prompt: "What is the number of Lord Commanders that have served when Jon is elected?",
		choices: ["292","731","31","997"],
		answer: "997"
	},
	{
		prompt: "What does Bronn save Jaime from being killed by?",
		choices: ["Jaguar","Boar","Rats","Snake"],
		answer: "Snake"
	},
	{
		prompt: "Who says the name of the episode in 'The Wars To Come'?",
		choices: ["Mance","Daenerys","Tyrion","Sam"],
		answer: "Mance"
	}
];

|-> store -> component -> actions (events) -v
|                                           |
--------------------<-----------------------|

React.render(
	<QuestionsBox quiz={quiz} />,
	document.getElementById('content')
);

	</script>

	</body>
</html>
